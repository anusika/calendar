<!doctype html>
<html>
  <head>
        <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/styles.css') }}">
    <title>Assigment Organizer</title>
  </head>

  <body>

    <div class = "header">

    <form action="/reload/" method = "post" >
    <button type="submit" class="btn btn-primary flex-item"> Reload From Canvas </button>
    </form>

    <br><br>

    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary flex-item" data-toggle="modal" data-target="#addModal">
      Add Assigment
    </button>
    </div>

    <table class = "table">
      <tr>
        <th>Course Name</th>
        <th>Assigment Name</th>
        <th> Assigment ID </th>
        <th>Due Date</th>
        <th>Points</th>
        <th>Submitted</th>
        <th>Options</th>
      </tr>
    {% for line in data %}
    <tr class = '{{"True" if line[6] else "False"}}'>
      <td >{{line[0]}} </td>
      <td>{{line[2]}} </td>
      <td> {{line[3]}} </td>
      <td>{{line[4]}} </td>
      <td>{{line[5]}} </td>
      <td>
        {% if line[6] %}
          Yes
        {% else %}
          No
        {% endif %}
      </td>
      <td class = "header"> 
        <form action = "/toggle/" method = "post">
          <button name = "{{line[3]}}" value = "{{line[6]}}" class = "left btn {{"btn-primary" if not line[6] else "btn-light"}}"> 
            {% if line[6] %}
            Unsubmit
          {% else %}
            Submit
          {% endif %}
          </button>
        </form>
        <form action = "/toggle/" method = "post">
          <button name = "{{line[3]}}" value = "{{line[6]}}" class = "middle btn {{"btn-primary" if not line[6] else "btn-light"}}"> Edit </button>
        </form>
        <form action = "/delete/" method = "post">
          <button type="button" class = "right btn {{"btn-danger" if not line[6] else "btn-light"}}" data-toggle="modal" data-target = "#deleteModal" data-id="{{line[3]}}" data-name="{{line[2]}}"> 
            Delete </button>
        </form>
      </td>
    <tr>
    {% endfor %}
    </table>



<!-- Modal -->
<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Assigment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="/add/" method = "post">
          <div class = "form-group">
            <label for="courseCode">Course Name</label>
            <select name = "courseCode" class="form-control" id="courseCode" selected="{{courses[0]}}">
              {% for line in courses.keys() %}
              <option value = "{{courses[line]}}">{{line}}</option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
          <label for="AssigmentName">Assigment Name:</label><br>
          <input type="text" id="AssigmentName" name="assigmentName" class = "form-control">
          </div>

          <div class="form-group">
            <label for="dueDate">Due Date:</label> <br>
            <input type="datetime-local" id="dueDate" name="dueDate" class = "form-control">
          </div>

          <div class="form-group">
            <label for="points">Points:</label> <br>
            <input type="number" id="points" name="points" class = "form-control">
          </div>
          <button type="submit" class="btn btn-primary"> Add </button>
          </form>
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Delete Assigment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this assigment?</p>
        <p><b> Assigment Name: </b><div class = "assigmentName">Example </div> </p>
        <p><b> Assigment ID: </b> <div class = "assigmentId"> Example </div></p>
        <form action="/delete/" method = "post">
          <button type="submit" class="btn btn-danger" id = "toDelete" name = "toDelete" value = "example"> Delete </button>
          </form>
      </div>
    </div>
  </div>
</div>

<script>
  $('#deleteModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var name = button.data('name') // Extract info from data-* attributes
  var id = button.data('id')
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  var modal = $(this)
  modal.find('.assigmentName').text(name)
  modal.find('.assigmentId').text(id)
  document.getElementById("toDelete").value = id;
})
</script>
</body>
</html>